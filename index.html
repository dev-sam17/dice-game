<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Dice Game</title>
    <style>
        canvas {
            border: 1px solid black;
            display: block;
        }

        video {
            visibility: hidden;
        }
    </style>
</head>

<body>
    <canvas id="myCanvas" width="500" height="500"></canvas>
    <video id="myVideo" autoplay loop muted>
        <source src="background-video.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <script>
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');
        const video = document.getElementById('myVideo');

        const buttonImage = new Image();
        buttonImage.src = 'download.jpeg';  // Path to your "Play Now" button image

        const button = {
            x: canvas.width - 100,
            y: canvas.height - 50,
            width: 80,
            height: 40
        };

        const rollButtonImage = new Image();
        rollButtonImage.src = 'button-image.png';  // Path to your "Roll Dice" button image

        const rollButton = {
            x: canvas.width / 2 - 50,  // Centered horizontally
            y: canvas.height - 100,    // Positioned above the bottom
            width: 100,
            height: 50
        };


        let gameStarted = false;
        let drawFunction = null

        video.addEventListener('play', function () {
            function drawFrame() {
                if (drawFunction) {
                    drawFunction()
                }

                if (!video.paused && !video.ended) {
                    // Draw the video frame onto the canvas
                    requestAnimationFrame(drawFrame); // Schedule the next frame
                }
            }
            drawFrame(); // Start drawing the video to the canvas
        });

        function handlePlayNowButton(event) {
            {
                const rect = canvas.getBoundingClientRect();
                const mouseX = event.clientX - rect.left;
                const mouseY = event.clientY - rect.top;

                // Check if the "Play Now" button is clicked
                if (
                    mouseX >= button.x &&
                    mouseX <= button.x + button.width &&
                    mouseY >= button.y &&
                    mouseY <= button.y + button.height
                ) {
                    console.log("play now clicked")
                    loadPage("page2")
                }


            }
        }

        function handleRollDice(event) {
            const rect = canvas.getBoundingClientRect();
            const mouseX = event.clientX - rect.left;
            const mouseY = event.clientY - rect.top;


            // Check if the "Roll Dice" button is clicked after the game has started
            if (mouseX >= rollButton.x && mouseX <= rollButton.x + rollButton.width &&
                mouseY >= rollButton.y && mouseY <= rollButton.y + rollButton.height) {
                rollDice();
            }
        }

        function loadPage1EventListeners() {
            canvas.removeEventListener('click', handleRollDice)

            canvas.addEventListener('click', handlePlayNowButton);
        }

        function loadPage2EventListeners() {
            canvas.removeEventListener('click', handlePlayNowButton)

            canvas.addEventListener('click', handleRollDice);
        }



        // Function to start the game, re-render the canvas with a solid background
        function loadGame() {
            console.log("start game screen")
            // Clear the canvas and draw a solid background (e.g., blue color)
            ctx.fillStyle = 'blue'; // You can change this to any colors
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw the "Roll Dice" button
            ctx.drawImage(rollButtonImage, rollButton.x, rollButton.y, rollButton.width, rollButton.height);
        }

        // Function to roll two dice and display the result
        function rollDice() {
            const dice1 = Math.floor(Math.random() * 6) + 1; // Random number between 1 and 6
            const dice2 = Math.floor(Math.random() * 6) + 1;
            const total = dice1 + dice2;

            // Clear the canvas and re-render the solid background
            ctx.fillStyle = 'blue'; // Same background color as in startGame()
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw dice values on the canvas
            ctx.font = '48px Arial';
            ctx.fillStyle = 'white';
            ctx.fillText(`Dice 1: ${dice1}`, 100, 100);
            ctx.fillText(`Dice 2: ${dice2}`, 100, 160);
            ctx.fillText(`Total: ${total}`, 100, 220);

            // Draw the "Roll Dice" button again
            ctx.drawImage(rollButtonImage, rollButton.x, rollButton.y, rollButton.width, rollButton.height);
        }

        function loadPage(page) {
            switch (page) {
                case "page1":
                    drawFunction = drawPage1
                    loadPage1EventListeners()
                    break;
                case "page2":
                    drawFunction = drawPage2
                    loadPage2EventListeners()
                    gameStarted = true;

                    loadGame()
                    break;
            }
        }


        function drawPage1() {
            loadPage1EventListeners(button)

            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            ctx.drawImage(buttonImage, button.x, button.y, button.width, button.height);

        }

        function drawPage2() {
            loadPage2EventListeners();

        }


        loadPage("page1")
    </script>
</body>

</html>